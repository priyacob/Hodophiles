(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[12498],{60139:t=>{"use strict";function e(t){return function(){return t}}var n=function(){};n.thatReturns=e,n.thatReturnsFalse=e(!1),n.thatReturnsTrue=e(!0),n.thatReturnsNull=e(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(t){return t},t.exports=n},663620:(t,e,n)=>{"use strict";var a=n(60139);t.exports=a},791773:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});let a=(0,n(667294).createContext)(null)},288544:(t,e,n)=>{"use strict";n.d(e,{Z:()=>U});var a=n(667294),r=n(983272),i=n(630118),o=n(845729),s=n(248750),l=n(353168),p=n(770975),u=n(2171),d=n(201930),c=n(920301),m=n(431771),_=n(142921),g=n(301567);let f=t=>{let e=performance.getEntriesByType("resource").filter(t=>t.name.includes("i.pinimg")).reduce((t,e)=>{let n=e.name.replace(".jpg","").split("/");return{[n[n.length-1]]:{downloadSize:e.name.split("/")[3].split("x")[0]},...t}},{});[...Array.from(document.getElementsByTagName("img")).map(t=>{let n=t.src.replace(".jpg","").split("/"),a=n[n.length-1];if(e[a]){let n=g.rZ(t)?.width||1,r=e[a].downloadSize;return{fileName:a,renderedSize:n,downloadedSize:r,ratio:r/n}}return{fileName:a,renderedSize:1,downloadedSize:1,ratio:1}}),...Array.from(document.querySelectorAll('div[role="img"]')).map(t=>{let n=t.style.backgroundImage.split('"')[1].replace(".jpg","").split("/"),a=n[n.length-1];if(e[a]&&t instanceof HTMLDivElement){let n=g.rZ(t)?.width||1,r=e[a].downloadSize;return{fileName:a,renderedSize:n,downloadedSize:r,ratio:r/n}}return{fileName:a,renderedSize:1,downloadedSize:1,ratio:1}})].forEach(e=>{let{ratio:n,fileName:a,downloadedSize:r}=e;e.ratio>1.05&&(0,s.A9)(`checkImageRatio.${t}`,{count:Math.round(10*n)/10,tags:{fileName:`${r}_${a}`}})})};var y=n(147921),A=n(671481),w=n(730212);let T=(t,e)=>{let n=(0,a.useRef)(e);return{getState:()=>n.current,dispatch:e=>{n.current=t(n.current,e)}}};var I=n(493651),S=n(415787),h=n(785893);let E=["initial_app_load","client_route_push"],M=(0,o.XV)("PwtSurface"),v="NavigationComplete",N="VisuallyComplete",x=(t,e,n,a)=>{let{metricConfig:{metricId:r,pwtStaticContext:i,annotateExperiments:o},annotations:s,binaryAnnotations:l,constraintMap:p,startTime:m,imageTimings:_,isSampled:g,spans:f,traceId:y}=t,A=(0,u.N)({reason:e,annotateExperiments:o,annotations:s,binaryAnnotations:l,constraintMap:p,endTime:n,imageTimings:_,metricId:r,pwtStaticContext:i,startTime:m,traceId:y,spans:f});g&&!a&&(0,c.Z)({metricId:r,pwtStaticContext:i,result:A,annotateExperiments:o?["web_perf_logger_v4",...o]:["web_perf_logger_v4"]}),(0,d.D9)()},b=(t,e,n)=>{let{metricConfig:{metricId:a,pwtStaticContext:r,annotateExperiments:o},annotations:p,binaryAnnotations:m,constraintMap:_,startTime:g,imageTimings:y,isSampled:A,spans:w,traceId:T}=t;(0,l.L8)(`Report_PWT_Complete_${(0,i.KJ)(a)}`);let I=(0,u.W)({annotateExperiments:[...o??[],"web_perf_logger_v4"],annotations:p,binaryAnnotations:m,constraintMap:_,endTime:e,imageTimings:y,metricId:a,pwtStaticContext:r,startTime:g,traceId:T,spans:w});A&&!n&&(0,c.Z)({metricId:a,pwtStaticContext:r,result:I,annotateExperiments:o?["web_perf_logger_v4",...o]:["web_perf_logger_v4"]});try{f(String(I.binaryAnnotationMap["metricId.surface"].value))}catch(t){(0,s.H)("image_ratio_check_error",{error:t})}return(0,d.D9)(),{...t,result:I,status:"DONE"}},C=(t,e)=>{if(t.metricConfig.constraints.every(e=>t.constraintMap[e])){let n=Math.max(...t.metricConfig.constraints.map(e=>t.constraintMap[e]));return b(t,n,e)}return M(`Remaining constraints: ${t.metricConfig.constraints.filter(e=>!t.constraintMap[e]).join(", ")}`),t},R=(t,e)=>{let{constraint:n,time:a,disablePWTLogging:r}=e,o=(0,i.KJ)(t.metricConfig.metricId);return A.Z?t.metricConfig.constraints.find(t=>t===n)?t.constraintMap[n]?(M(`constraint "${n}" is already complete.`),(0,s.H)("duplicated_constraint_complete",{constraint:n,action:o}),t):(M(`marking constraint "${n}" as complete ${a||performance.now()}`),a?(0,l.ZP)(`constraint_${n}_is_complete`,a):(0,l.ZP)(`constraint_${n}_is_complete`),C({...t,constraintMap:{...t.constraintMap,[n]:a||A.Z.now()}},r)):(M(`marked constraint "${n}" is not a required constraint.`),t):((0,s.H)("missing_window_performance",{action:o}),t)},O=(t,e)=>{if(!A.Z){let e=(0,i.KJ)(t.metricConfig.metricId);(0,s.H)("missing_window_performance",{action:e})}M(`removing constraint "${e}"`);let n=t.metricConfig.constraints.filter(t=>t!==e),{[e]:a,...r}=t.constraintMap;return C({...t,constraintMap:r,metricConfig:{...t.metricConfig,constraints:n}})},Z=(t,e)=>{if(!A.Z){let e=(0,i.KJ)(t.metricConfig.metricId);(0,s.H)("missing_window_performance",{action:e})}M(`updating pwt segment to "${e}"`);let n={...t.metricConfig.metricId,segment:e};return{...t,metricConfig:{...t.metricConfig,metricId:n}}},L=(t,e)=>{let{metricConfig:n,startTime:a,isSampled:r,disablePWTLogging:o}=e;if(o||"TIMING"!==t.status||a===t.startTime||x(t,"routeUpdatedOnSameSurface",A.Z?.now()||0,o),!n)return{status:"DISABLED",metricConfig:null};let l=(0,i.KJ)(n.metricId);if("TIMING"===t.status&&t.startTime===a&&t.constraintMap[v])return(0,s.H)("duplicated_init_route_action",{action:l}),t;if(!o){if("Other"===n.pwtStaticContext.browserName&&!1===n.metricId.isAuthenticated&&"initial_app_load"===n.metricId.navigationType)(0,s.A9)(`TIMING.${l}`,{tags:{userAgent:window?.navigator?.userAgent}}),(0,s.A9)(`TIMING.sampled.${l}`,{tags:{userAgent:window?.navigator?.userAgent},sampleRate:.03});else{(0,s.A9)(`TIMING.${l}`),(0,s.A9)(`TIMING.sampled.${l}`,{sampleRate:.03});let t=void 0!==n.metricId.isAuthenticated&&{tags:{isAuth:n.metricId.isAuthenticated}}||void 0;(0,c.C)({resultLog:`TIMING.${l}`,annotateExperiments:n.annotateExperiments||[],getExperimentGroup:n.pwtStaticContext.getExperimentGroup,options:t})}}return R({traceId:(0,d.Vd)()||(0,d.ZP)("initial_app_load"===n.metricId.navigationType,n.pwtStaticContext.serverData?.trace_id),status:"TIMING",metricConfig:n,startTime:a,constraintMap:{},annotations:{},binaryAnnotations:{},imageTimings:[],isSampled:r,spans:[]},{constraint:v,disablePWTLogging:o})},P=(t,e)=>{if(M("dispatch action",e),"INIT_ROUTE"===e.type)return L(t,e.payload);if("TIMING"!==t.status)return M(`ignoring action due to invalid state ${t.status}`,e),t;switch(e.type){case"ABORT":x(t,e.reason,A.Z?.now()||0);let n={type:"ABORT",reason:e.reason};return{...t,status:"DONE",result:n};case"ANNOTATE":let{name:a}=e.payload;if(!A.Z)return t;let r=A.Z.now();return M(`adding annotation {${a}: ${r}}`),{...t,annotations:{...t.annotations,[a]:r}};case"BINARY_ANNOTATE":let{name:o,value:l,annotationType:p}=e.payload;return M(`adding binary annotation {${o}: ${l}}`),{...t,binaryAnnotations:{...t.binaryAnnotations,[o]:{value:l,type:p}}};case"MARK_CONSTRAINT_COMPLETE":return R(t,e.payload);case"REMOVE_CONSTRAINT":return O(t,e.payload);case"SET_SEGMENT":return Z(t,e.payload);case"SET_VISUALLY_COMPLETE_RESULT":{let{payload:{imageTimings:n}}=e;if(0===n.length)return x(t,"visuallyComplete_noImages",A.Z?.now()||0),{...t,status:"DONE",result:{type:"ABORT",reason:"visuallyComplete_noImages"}};let a=Math.max(...n.map(t=>t.responseEnd||0));return R({...t,imageTimings:n},{constraint:N,time:a})}case"ADD_SUBSPAN":let{startTime:u}=t,{payload:{name:d,startTime:c,endTime:m,annotations:_,binaryAnnotations:g,parentId:f}}=e;return{...t,spans:[...t.spans,{name:d,id:(0,y.Z)(),startTime:c||u,endTime:m,annotationMap:{..._},binaryAnnotationMap:{...g},parentId:f}]};case"START_SUBSPAN":return{...t,spans:[...t.spans,{name:e.payload.name,id:(0,y.Z)(),startTime:A.Z?A.Z.now():0,endTime:1/0,annotationMap:{...e.payload.annotations},binaryAnnotationMap:{...e.payload.binaryAnnotations},parentId:e.payload.parentId}]};case"STOP_SUBSPAN":let w=t.spans.findIndex(t=>t.name===e.payload.name);return w>-1?(t.spans[w].endTime=A.Z?A.Z.now():0,e.payload.annotations&&(t.spans[w].annotationMap={...t.spans[w].annotationMap,...e.payload.annotations}),e.payload.binaryAnnotations&&(t.spans[w].binaryAnnotationMap={...t.spans[w].binaryAnnotationMap,...e.payload.binaryAnnotations})):(0,s.H)("invalid_subspan_stop_name",{name:e.payload.name}),t;default:let T=(0,i.KJ)(t.metricConfig.metricId);return(0,s.H)("invalid_pwt_surface_action",{action:T}),t}},$=t=>{if(!t)return"initial_app_load";switch(t.action){case"PUSH":return"client_route_push";case"REPLACE":return"client_route_replace";default:return null}},D=new Set,B=({surface:t,constraints:e,segment:n,measureGridVisuallyComplete:i,annotateExperiments:o,customEnabledNavigationTypes:s,navigationInfo:{clientNavigation:l,navigationType:p},sampleRate:u})=>{let d=(0,a.useRef)("NOT_SET"),c=(0,_.Z)(),{getState:m,dispatch:g}=T(P,{status:"DISABLED",metricConfig:null}),f=(0,w.B)();if(d.current!==l&&(d.current=l,c)){let{isAuthenticated:a}=c,r=t&&p&&(s||E).includes(p)?{metricId:{type:"surface",surface:t,navigationType:p,isAuthenticated:a,segment:n},annotateExperiments:o,constraints:[v,...e||[],...i?[N]:[]],pwtStaticContext:c}:null;(0,S.nP)("webapp.pwt_surface.init_route",{tags:{surface:t,navigationType:p,isAuthenticated:a}});let d=!D.has(l);g({type:"INIT_ROUTE",payload:{metricConfig:r,startTime:l?l.time:0,isSampled:!u||Math.random()<u,disablePWTLogging:!d}}),d&&D.add(l)}let y=m();if((0,a.useEffect)(()=>()=>{D.delete(l)},[l]),(0,a.useEffect)(()=>{let t=t=>{g({type:"ABORT",reason:t})};r.Z.onSessionPause(t);let e=window.innerHeight,n=window.innerWidth,a=()=>{let t=Math.abs(window.innerHeight-e),r=Math.abs(window.innerWidth-n),i=window.innerHeight!==e,o=window.innerWidth!==n,s={handler:(0,I.H)(),deviceType:c?.deviceType??"unknown",isAuthenticated:c?.isAuthenticated??"unknown",platform:f.userAgent.platform??"unknown"};if((0,S.nP)("webapp.PwtLogger.handleResize",{sampleRate:1,tags:{...s,heightChanged:i,widthChanged:o}}),i&&(0,S.S0)("webapp.PwtLogger.resizeHeightDelta",t,{sampleRate:1,tags:s}),o&&(0,S.S0)("webapp.PwtLogger.resizeWidthDelta",r,{sampleRate:1,tags:s}),window.removeEventListener("resize",a),c?.deviceType==="phone"&&(!o&&i&&t<=150||!i&&!o)||c?.deviceType==="desktop"&&!i&&!o){(0,S.nP)("webapp.PwtLogger.skipResizeAbort",{sampleRate:1,tags:{...s,heightChanged:i,widthChanged:o}});return}g({type:"ABORT",reason:"windowResized"})};return window.addEventListener("resize",a),()=>{let e=m();M("handling unmount",e),"TIMING"===e.status&&x(e,"unmount",A.Z?.now()||0),r.Z.removePauseListener(t),window.removeEventListener("resize",a)}},[]),"TIMING"!==y.status||!y.constraintMap[v])return{state:y,context:null};let{startTime:h,metricConfig:b}=y;return{state:y,context:{abort:t=>g({type:"ABORT",reason:t}),addAnnotation:t=>g({type:"ANNOTATE",payload:{name:t}}),addBinaryAnnotation:(t,e,n)=>g({type:"BINARY_ANNOTATE",payload:{name:t,value:e,annotationType:n}}),addSubspan:(t,e,n,a={},r={},i=null)=>g({type:"ADD_SUBSPAN",payload:{name:t,startTime:e,endTime:n,annotations:a,binaryAnnotations:r,parentId:i}}),getId:()=>h,getMetricId:()=>b.metricId,markConstraintComplete:t=>g({type:"MARK_CONSTRAINT_COMPLETE",payload:{constraint:t,time:A.Z?A.Z.now():0}}),removeConstraint:t=>g({type:"REMOVE_CONSTRAINT",payload:t}),setSegment:t=>g({type:"SET_SEGMENT",payload:t}),setVisuallyCompleteResult:b.constraints.includes(N)?t=>g({type:"SET_VISUALLY_COMPLETE_RESULT",payload:t}):null,startSubspan:(t,e={},n={},a=null)=>g({type:"START_SUBSPAN",payload:{name:t,annotations:e,binaryAnnotations:n,parentId:a}}),stopSubspan:(t,e={},n={},a=null)=>g({type:"STOP_SUBSPAN",payload:{name:t,annotations:e,binaryAnnotations:n,parentId:a}})}}},H=()=>{let t=(0,p.E)(),e=!!t;(0,a.useEffect)(()=>{if(e){let e=t?.getMetricId(),n=e?(0,i.KJ)(e):null;(0,s.H)("nested_pwt_surface",{action:n})}},[e])};function U({children:t,...e}){let n=(0,m.Z)(),a=$(n),r=e.measureGridVisuallyComplete?["web_masonry_v2_auth","web_masonry_v2_unauth","web_fluid_grid_desktop_auth","web_fluid_grid_desktop_unauth"]:[],i=[...e.annotateExperiments??[],...r,"web_perf_logger_v4"],{context:o}=B({...e,annotateExperiments:i,navigationInfo:{navigationType:a,clientNavigation:n}});return H(),(0,h.jsx)(p.S,{value:o,children:t})}},431771:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var a=n(667294),r=n(791773);function i(){return(0,a.useContext)(r.Z)}},373897:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a},t.exports.__esModule=!0,t.exports.default=t.exports},163405:(t,e,n)=>{var a=n(373897);t.exports=function(t){if(Array.isArray(t))return a(t)},t.exports.__esModule=!0,t.exports.default=t.exports},564836:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports},379498:t=>{t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},742281:t=>{t.exports=function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},600861:(t,e,n)=>{var a=n(163405),r=n(379498),i=n(386116),o=n(742281);t.exports=function(t){return a(t)||r(t)||i(t)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},386116:(t,e,n)=>{var a=n(373897);t.exports=function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=({}).toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/12498-a662fa11eae682fe.mjs.map